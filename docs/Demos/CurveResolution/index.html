<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Curve Resolution · ChemometricsTools</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>ChemometricsTools</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Demos</span><ul><li><a class="toctext" href="../Transforms/">Transforms</a></li><li><a class="toctext" href="../Pipelines/">Pipelines</a></li><li><a class="toctext" href="../ClassificationExample/">Classification</a></li><li><a class="toctext" href="../RegressionExample/">Regression</a></li><li><a class="toctext" href="../SIPLS/">SIPLS</a></li><li><a class="toctext" href="../CalibXfer/">Calibration Transfer</a></li><li class="current"><a class="toctext" href>Curve Resolution</a><ul class="internal"></ul></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../../man/Preprocess/">Preprocessing</a></li><li><a class="toctext" href="../../man/Transformations/">Transformations/Pipelines</a></li><li><a class="toctext" href="../../man/Sampling/">Sampling</a></li><li><a class="toctext" href="../../man/Training/">Training</a></li><li><a class="toctext" href="../../man/TimeSeries/">Time Series</a></li><li><a class="toctext" href="../../man/RegressionModels/">Regression Models</a></li><li><a class="toctext" href="../../man/regressMetrics/">Regression Metrics</a></li><li><a class="toctext" href="../../man/ClassificationModels/">Classification Models</a></li><li><a class="toctext" href="../../man/classMetrics/">Classification Metrics</a></li><li><a class="toctext" href="../../man/Trees/">Tree Methods</a></li><li><a class="toctext" href="../../man/Ensemble/">Ensemble Models</a></li><li><a class="toctext" href="../../man/Clustering/">Clustering</a></li><li><a class="toctext" href="../../man/MultiWay/">MultiWay</a></li><li><a class="toctext" href="../../man/AnomalyDetection/">Anomaly Detection</a></li><li><a class="toctext" href="../../man/CurveResolution/">Curve Resolution</a></li><li><a class="toctext" href="../../man/Stats/">Stats.</a></li><li><a class="toctext" href="../../man/Dists/">Distance Measures</a></li><li><a class="toctext" href="../../man/PSO/">PSO</a></li><li><a class="toctext" href="../../man/GeneticAlgorithms/">Genetic Algorithms</a></li></ul></li><li><a class="toctext" href="../../man/FullAPI/">Full API</a></li></ul></nav><article id="docs"><header><nav><ul><li>Demos</li><li><a href>Curve Resolution</a></li></ul><a class="edit-page" href="https://github.com/caseykneale/ChemometricsTools.jl/blob/master/docs/src/Demos/CurveResolution.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Curve Resolution</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Curve-Resolution-Demo-1" href="#Curve-Resolution-Demo-1">Curve Resolution Demo</a></h1><p>ChemometricsTools has some curve resolution methods baked in. So far NMF, SIMPLISMA, and MCR-ALS are included. If you aren&#39;t familiar with them, they are used to extract spectral and concentration estimates from unknown mixtures in chemical signals. Below is an example of spectra which are composed of signals from a mixture of a 3 components. I could write a volume analyzing this simple set, but this is just a show-case of some methods and how to call them, what kind of results they might give you. The beauty of this example is that, we know what is in it, in a forensic or real-world situation we won&#39;t know what is in it, and we have to rely on domain knowledge, physical reasoning, and metrics to determine the validity of our results.</p><p>Anyways, because we know, the pure spectra look like the following: <img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/PureSComps.png" alt="pure"/></p><p><em>Note: There are three components (water, acetic acid, methanol), but their spectra were collected in duplicate.</em></p><p>And the concentration profiles of the components follow the following simplex design, <img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/PureCComps.png" alt="pureC"/></p><p>But the models we are using will only see the following (no pure components) <img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/mixture.png" alt="impure"/></p><pre><code class="language-julia">Raw = CSV.read(&quot;/triliq.csv&quot;);
Mixture = collect(convert(Array, Raw)[:,1:end]);
pure = [10,11,20,21,28,29];
PURE = Mixture[pure,:];
impure = [collect(1:9); collect(12:19);collect(22:27)];
Mixture = Mixture[impure,:];</code></pre><p>Great, so now let&#39;s run NMF, SIMPLISMA, and MCR-ALS with the SIMPLISMA estimates.</p><pre><code class="language-julia">( W_NMF, H_NMF ) = NMF(Mixture; Factors = 3, maxiters = 300, tolerance = 1e-8)
(C_Simplisma,S_Simplisma, vars) = SIMPLISMA(Mixture; Factors = 18)
vars
#Find purest variables that are not neighbors with one another
cuts = S_Simplisma[ [1,3,17], :];
( C_MCRALS, S_MCRALS, err ) = MCRALS(Mixture, nothing, RangeNorm(cuts&#39;)(cuts&#39;)&#39;;
                                    Factors = 3, maxiters = 10,
                                    norm = (true, false),
                                    nonnegative = (true, true) )</code></pre><hr/><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/NMFS.png" alt="NMFS"/></p><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/SIMPLISMAS.png" alt="SIMPLISMAS"/></p><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/MCRALSS.png" alt="MCRALSS"/></p><h3><a class="nav-anchor" id="Spectral-Recovery-Discussion-(Results-by-Eye):-1" href="#Spectral-Recovery-Discussion-(Results-by-Eye):-1">Spectral Recovery Discussion (Results by Eye):</a></h3><p>As we can see, NMF does resolve a few components that resemble a few of the actual pure components, but it really butchers the 3rd. While SIMPLISMA does a good job, at finding spectra that look &quot;real&quot; there are characteristics missing from the true spectra. It must be stated; SIMPLISMA wasn&#39;t invented for NIR signals. Finding <em>pure variables</em> in dozens... err... hundreds of over-lapping bands isn&#39;t really ideal. However, MCR-ALS quickly made work of those initial SIMPLISMA estimates and seems to have found some estimates that somewhat closely resemble the pure components.</p><hr/><h3><a class="nav-anchor" id="Concentration-Profile-Discussion-(Results-by-Eye):-1" href="#Concentration-Profile-Discussion-(Results-by-Eye):-1">Concentration Profile Discussion (Results by Eye):</a></h3><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/NMFC.png" alt="NMFC"/></p><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/SIMPLISMAC.png" alt="SIMPLISMAC"/></p><p><img src="https://raw.githubusercontent.com/caseykneale/ChemometricsTools/master/images/CurveResolutionDemo/MCRALSC.png" alt="MCRALSC"/></p><p>SIMPLISMA basically botched this dataset with regards to the concentration profiles. While NMF and MCR-ALS do quite good. Of course preprocessing can help here, and tinkering too. Ultimately not bad, given the mixture components. I do have a paper that shows another approach to this problem doubtful I&#39;d be allowed to rewrite the code, I think my university owns it!</p><p>Casey Kneale, Steven D. Brown, <a href="http://www.sciencedirect.com/science/article/pii/S0003267018309188">Band target entropy minimization and target partial least squares for spectral recovery and quantitation</a>, Analytica Chimica Acta, Volume 1031, 2018, Pages 38-46, ISSN 0003-2670, https://doi.org/10.1016/j.aca.2018.07.054.</p><footer><hr/><a class="previous" href="../CalibXfer/"><span class="direction">Previous</span><span class="title">Calibration Transfer</span></a><a class="next" href="../../man/Preprocess/"><span class="direction">Next</span><span class="title">Preprocessing</span></a></footer></article></body></html>
